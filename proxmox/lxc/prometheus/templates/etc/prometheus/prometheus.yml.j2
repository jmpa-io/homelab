---

# {{ ansible_managed }}

# Global configuration.
global:
  scrape_interval: 30s      # The scape interval; Default is every 1 minute.
  scrape_timeout: 15s       # The scrape timeout; Default is 10s.
  evaluation_interval: 30s  # How often rules are evaluated rules; Default is every 1 minute.

# Web configuration.
web:
  listen_address: ":"

# Alertmanager configuration.
#alerting:
#  alertmanagers:
#    - static_configs:
#        - targets:
#           - alertmanager:9093

# Rules configuration.
# NOTE: Rules are loaded once and periodically evaluated according to the global 'evaluation_interval'.
rule_files:
  # - "first_rules.yml"
  # - "second_rules.yml"

# Scrape configuration.
scrape_configs:

  # Internal monitoring.
  - job_name: prometheus
    static_configs:
      - targets: ["localhost:9090"]

  # Open Telemetry Collector.
  - job_name: "{{ hostvars[inventory_hostname].host.name }}"
    static_configs:
      - targets: ["{{ hostvars[inventory_hostname].ansible_host }}:{{ hostvars[inventory_hostname].host.collector.metrics_port }}"]

